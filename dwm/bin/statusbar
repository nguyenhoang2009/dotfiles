#!/bin/bash
#
# Status Bar for dwm

# Colour codes from dwm/config.h
colour_gry="\x01" # grey on black
colour_wht="\x02" # white on black
colour_dgry="\x04" # darkgrey on black
colour_blk="\x05" # black on darkgrey
colour_red="\x06" # colour_red on black
colour_grn="\x07" # green on black
colour_dylw="\x08" # orange on black
colour_ylw="\x09" # yellow on black
colour_blu="\x0A" # colour_blue on darkgrey
colour_mag="\x0B" # colour_magenta on darkgrey
colour_cyn="\x0C" # cyan on darkgre

# Icon glyphs from font xbmicons.pcf
glyph_msc="\uE00E"
glyph_cpu="\uE00F"
glyph_mem="\uE010"
glyph_dl="\uE011"
glyph_ul="\uE012"
glyph_com="\uE013"
glyph_eml="\uE014"
glyph_vol="\uE015"
glyph_tim="\uE016"
glyph_tor="\uE017"
sep_solid="\uE01A"
sep_line="\uE01B"
sep_bar="\uE020"

_date()
{
  d="(date +'%a %k:%M %d/%b/%Y')"
  echo -en "\x01${d}"
}

_volume()
{
  v="$(amixer get PCM | tail -n1 | sed -r 's/.*\[(.*)%\].*/\1/')"
  echo -en "\x04$\uE01A\x0B\uE015 ${v}% "
}

_mem()
{
  m="$(free -m | awk 'NR==2 {print $3}')"
  echo -en "\uE01B\uE010 ${m}M"
}

_battery()
{
  b="$(acpi | awk '{print $NF}')"
  echo -en "\x01 ${b}"
}

while true; do
  #dwm_status="Power: "$b" | Vol: "$v" | "$d"";
	xsetroot -name "$(_battery) $(_volume) $(_mem) $(_date)"
	sleep 1
done
